local Internal: table = require("@env/internal")
local Crypt: table = require("@rlibrary/crypt")
local Cache: table = require("@rlibrary/cache")
local Console: table = require("@rlibrary/console")
local Closures: table = require("@rlibrary/closures")
local Compression: table = require("@rlibrary/compression")
local Debug: table = require("@rlibrary/debug")
local Drawing: table = require("@rlibrary/drawing")
local Enconding: table = require("@rlibrary/encoding")
local FileSystem: table = require("@rlibrary/filesystem")
local Keyboard: table = require("@rlibrary/keyboard")
local Misc: table = require("@rlibrary/misc")
local Mouse: table = require("@rlibrary/mouse")
local Table: table = require("@rlibrary/table")
local WebSocket: table = require("@rlibrary/websocket")

local Script: table = Internal.Script
local API: table = Internal.Roblox

local Manager: table = require("@env/manager")
local Exploit: table = Manager.create()

Exploit:mount("crypt", Crypt)
Exploit:mount("debug", Debug)
Exploit:mount("Drawing", Drawing.Main)
Exploit:mount("WebSocket", WebSocket)

Exploit:extend(Cache)
Exploit:extend(Console)
Exploit:extend(Compression)
Exploit:extend(Closures)
Exploit:extend(Enconding)
Exploit:extend(FileSystem)
Exploit:extend(Keyboard)
Exploit:extend(Misc)
Exploit:extend(Mouse)
Exploit:extend(Table)
Exploit:extend(Drawing.Helpers)

Exploit:define("setidentity", "setthreadidentity", "setthreadcontext", function(Level)
  Exploit:checktype(1, Level, "number")
  
  Internal.ThreadIdentities[coroutine.running()] = Level
end)

Exploit:define("getidentity", "getthreadidentity", "getthreadcontext", function()
  return Internal.ThreadIdentities[coroutine.running()] or Internal.ThreadIdentities.Default
end)

Exploit:define("gethui", function(): Instance
  local CoreGui: Instance = Internal.DataModel:GetService("CoreGui")
  local Hidden: folder = CoreGui:FindFirstChild("Hidden")

  return Hidden
end)

Exploit:define("checkcaller", function()
  return true
end)

return Exploit:export() :: table